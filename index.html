<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.2.0/dist/aframe-extras.min.js"></script>
    
    <script>
      // 1. Logic for the "Meh" Guy to wander
      AFRAME.registerComponent('wanderer', {
        init: function () {
          this.targetPos = new THREE.Vector3();
          this.createNewTarget();
        },
        createNewTarget: function() {
          this.targetPos.set(Math.random()*10-5, 0, Math.random()*-10-2);
        },
        tick: function (time, timeDelta) {
          let currentPos = this.el.getAttribute('position');
          // Move slowly toward target
          if (this.targetPos.distanceTo(currentPos) < 0.1) {
            this.createNewTarget();
          } else {
            // Simple lerp math to move
            this.el.object3D.lookAt(this.targetPos);
            this.el.object3D.translateZ(0.02);
          }
        }
      });

      // 2. Destructible Logic (same as before)
      AFRAME.registerComponent('destructible', {
        init: function () {
          this.el.addEventListener('click', () => {
            this.el.setAttribute('visible', 'false');
            this.el.setAttribute('class', 'not-target');
            setTimeout(() => {
              this.el.setAttribute('visible', 'true');
              this.el.setAttribute('class', 'interactable');
            }, 5000);
          });
        }
      });
    </script>
  </head>
  <body>
    <a-scene renderer="antialias: true" cursor="rayOrigin: mouse">
      
      <a-assets>
        <a-mixin id="building" geometry="primitive: box" material="color: #555" destructible class="interactable"></a-mixin>
      </a-assets>

      <a-entity id="rig" movement-controls="speed: 0.15">
        <a-entity camera position="0 1.6 0" look-controls></a-entity>
        
        <a-entity oculus-touch-controls="hand: right" raycaster="objects: .interactable; showLine: true; far: 20" line="color: red; opacity: 0.5">
          <a-entity rotation="-45 0 0" position="0 0 0.05">
             <a-box width="0.03" height="0.12" depth="0.04" color="#111" position="0 -0.05 0"></a-box> <a-box width="0.035" height="0.04" depth="0.2" color="#222" position="0 0.02 -0.05"></a-box> </a-entity>
        </a-entity>

        <a-entity oculus-touch-controls="hand: left"></a-entity>
      </a-entity>

      <a-entity wanderer position="2 0 -4">
        <a-box color="orange" width="0.5" height="1" depth="0.5">
            <a-entity text="value: meh; align: center; color: black; width: 4" position="0 1.2 0" geometry="primitive: plane; width: 0.8; height: 0.4" material="color: white"></a-entity>
        </a-box>
        <a-sphere color="white" radius="0.1" position="0.15 0.3 0.26"></a-sphere>
        <a-sphere color="white" radius="0.1" position="-0.15 0.3 0.26"></a-sphere>
      </a-entity>

      <a-sky color="#87CEEB"></a-sky>
      <a-grid color="#444"></a-grid>
      <a-entity mixin="building" position="-4 2 -8" scale="2 4 2" material="color: #778899"></a-entity>
      <a-entity mixin="building" position="5 1.5 -6" scale="2 3 2" material="color: #444"></a-entity>

    </a-scene>
  </body>
</html>
